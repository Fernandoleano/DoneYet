<div class="max-w-7xl mx-auto" data-controller="cancellation">
  <!-- Current Subscription Status -->
  <% if @workspace.pro? %>
    <!-- Page Header -->
    <div class="mb-8">
      <h1 class="text-4xl font-black text-white mb-2">Subscription & Billing</h1>
      <p class="text-gray-400">Manage your DoneYet Pro subscription and billing details</p>
    </div>

    <!-- Subscription Overview Card -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
      <!-- Main Subscription Info -->
      <div class="lg:col-span-2 bg-gradient-to-br from-indigo-600 to-indigo-700 rounded-2xl p-8 border border-indigo-500 shadow-xl">
        <div class="flex items-start justify-between mb-6">
          <div>
            <div class="flex items-center gap-3 mb-2">
              <span class="text-3xl">üöÄ</span>
              <h2 class="text-3xl font-black text-white">DoneYet Pro</h2>
            </div>
            <p class="text-indigo-100">Active subscription with full access to all features</p>
          </div>
          <span class="px-4 py-2 bg-emerald-500 text-white text-sm font-bold rounded-full">ACTIVE</span>
        </div>
        
        <div class="grid grid-cols-2 gap-6 mb-6">
          <div>
            <p class="text-indigo-200 text-sm mb-1">Monthly Price</p>
            <p class="text-3xl font-black text-white">$18<span class="text-lg text-indigo-200">/month</span></p>
          </div>
          <div>
            <p class="text-indigo-200 text-sm mb-1">Next Billing Date</p>
            <p class="text-xl font-bold text-white"><%= (Date.today + 30.days).strftime("%b %d, %Y") %></p>
          </div>
        </div>

        <div class="flex gap-3">
          <button data-action="click->cancellation#openModal" class="flex-1 px-6 py-3 bg-white/10 hover:bg-white/20 text-white font-semibold rounded-lg transition border border-white/20 backdrop-blur-sm">
            Cancel Subscription
          </button>
          <a href="#" class="px-6 py-3 bg-white text-indigo-600 hover:bg-indigo-50 font-semibold rounded-lg transition">
            Update Payment Method
          </a>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="space-y-4">
        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-10 h-10 bg-indigo-600/20 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
            </div>
            <div>
              <p class="text-2xl font-black text-white"><%= @workspace.users.count %></p>
              <p class="text-sm text-gray-400">Team Members</p>
            </div>
          </div>
          <p class="text-xs text-gray-500">Unlimited on Pro</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-10 h-10 bg-emerald-600/20 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            </div>
            <div>
              <p class="text-2xl font-black text-white">50</p>
              <p class="text-sm text-gray-400">AI Commands/Hour</p>
            </div>
          </div>
          <p class="text-xs text-gray-500">10x more than Free</p>
        </div>
      </div>
    </div>

    <!-- Pro Features Grid -->
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-white mb-6">Your Pro Benefits</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-indigo-500/50 transition">
          <div class="w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Unlimited Team Members</h3>
          <p class="text-sm text-gray-400">Add as many team members as you need without restrictions</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-emerald-500/50 transition">
          <div class="w-12 h-12 bg-emerald-600/20 rounded-xl flex items-center justify-center mb-4">
            <span class="text-2xl">ü§ñ</span>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Enhanced AI Assistant</h3>
          <p class="text-sm text-gray-400">50 AI commands per hour for smart task management</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-purple-500/50 transition">
          <div class="w-12 h-12 bg-purple-600/20 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Advanced Analytics</h3>
          <p class="text-sm text-gray-400">Deep insights into team performance and productivity</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-cyan-500/50 transition">
          <div class="w-12 h-12 bg-cyan-600/20 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Priority Support</h3>
          <p class="text-sm text-gray-400">Get help faster with dedicated priority support</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-blue-500/50 transition">
          <div class="w-12 h-12 bg-blue-600/20 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Integrations</h3>
          <p class="text-sm text-gray-400">Connect with Slack, Google Meet, and more</p>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-amber-500/50 transition">
          <div class="w-12 h-12 bg-amber-600/20 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">Automated Workflows</h3>
          <p class="text-sm text-gray-400">Set up automations and smart reminders</p>
        </div>
      </div>
    </div>
  <% elsif @workspace.subscription_status == "past_due" %>
    <div class="mb-8 p-6 bg-gradient-to-r from-amber-600 to-amber-700 rounded-2xl border-2 border-amber-500 shadow-lg">
      <div class="flex items-center justify-between">
        <div>
          <h3 class="text-2xl font-bold text-white mb-2">‚ö†Ô∏è Payment Issue</h3>
          <p class="text-amber-100">Your payment is past due. Please update your payment method to continue using Pro features.</p>
        </div>
      </div>
    </div>
  <% end %>

  <% unless @workspace.pro? %>
  <!-- Header -->
  <div class="text-center mb-16">
    <h1 class="text-5xl font-black text-white mb-4">Choose Your Plan</h1>
    <p class="text-xl text-gray-400 max-w-2xl mx-auto">
      Start free and upgrade when you're ready for unlimited team members and advanced features.
    </p>
  </div>

  <!-- Pricing Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
    <!-- Free Plan -->
    <div class="bg-gray-800 border border-gray-700 rounded-2xl p-8 transform hover:-translate-y-1 transition duration-300">
      <div class="mb-6">
        <h3 class="text-2xl font-bold text-white mb-2">Free</h3>
        <p class="text-sm text-gray-400">Perfect for small teams getting started</p>
      </div>
      
      <div class="mb-6">
        <div class="flex items-baseline gap-1">
          <span class="text-4xl font-black text-white">$0</span>
        </div>
        <p class="text-sm text-gray-400 mt-1">Free forever</p>
      </div>

      <% if @workspace.free? %>
        <div class="w-full py-3 bg-gray-700 text-white font-semibold rounded-lg text-center mb-6">
          Current Plan
        </div>
      <% else %>
        <div class="w-full py-3 bg-gray-700/50 text-gray-400 font-semibold rounded-lg text-center mb-6 cursor-not-allowed">
          Downgrade (Contact Support)
        </div>
      <% end %>

      <div class="space-y-3 text-sm">
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-gray-300">Up to 5 team members</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-gray-300">Unlimited meetings</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-gray-300">Basic mission tracking</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-gray-300">Team chat & channels</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-gray-300">Email notifications</span>
        </div>
      </div>
    </div>

    <!-- Pro Plan -->
    <div class="bg-gradient-to-b from-indigo-600 to-indigo-700 border-2 border-indigo-500 rounded-2xl p-8 relative transform scale-105 shadow-2xl">
      <div class="absolute -top-4 left-1/2 -translate-x-1/2 px-4 py-1 bg-indigo-500 text-white text-xs font-bold rounded-full uppercase shadow-lg">
        Recommended
      </div>
      
      <div class="mb-6">
        <h3 class="text-2xl font-bold text-white mb-2">Pro</h3>
        <p class="text-sm text-indigo-100">For growing teams that need more</p>
      </div>
      
      <div class="mb-6">
        <div class="flex items-baseline gap-1">
          <span class="text-4xl font-black text-white">$18</span>
          <span class="text-indigo-100">/month</span>
        </div>
        <p class="text-sm text-indigo-100 mt-1">per workspace, billed monthly</p>
      </div>

      <% if @workspace.pro? %>
        <div class="w-full py-3 bg-white text-indigo-600 font-semibold rounded-lg text-center mb-6 shadow-lg">
          Current Plan ‚úì
        </div>
      <% elsif current_user.captain? %>
        <%= button_to "Upgrade to Pro", create_checkout_session_subscriptions_path, method: :post, 
            data: { turbo: "false" },
            class: "w-full py-3 bg-white hover:bg-gray-100 text-indigo-600 font-semibold rounded-lg transition mb-6 shadow-lg" %>
      <% else %>
        <div class="w-full py-3 bg-white/20 text-white font-semibold rounded-lg text-center mb-6 cursor-not-allowed">
          Only Captains Can Upgrade
        </div>
      <% end %>

      <div class="space-y-3 text-sm">
        <p class="text-indigo-100 font-semibold mb-2">Everything in Free, plus...</p>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-white mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-white">Unlimited team members</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-white mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-white">Advanced analytics dashboard</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-white mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-white">Priority support</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-white mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-white">Slack & Google Meet integrations</span>
        </div>
        <div class="flex items-start gap-2">
          <svg class="w-5 h-5 text-white mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
          <span class="text-white">Automated workflows & reminders</span>
        </div>
      </div>
    </div>
  </div>

  <% end %>

  <!-- FAQ Section -->
  <div class="mt-20 max-w-3xl mx-auto">
    <h2 class="text-3xl font-bold text-white text-center mb-10">Frequently Asked Questions</h2>
    <div class="space-y-4">
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-2">Can I cancel anytime?</h3>
        <p class="text-gray-400">Yes! You can cancel your Pro subscription at any time. You'll retain access until the end of your billing period.</p>
      </div>
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-2">What happens when I hit the 5-member limit on Free?</h3>
        <p class="text-gray-400">You'll need to upgrade to Pro to add more team members. All existing members will retain access.</p>
      </div>
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-2">Is my payment information secure?</h3>
        <p class="text-gray-400">Absolutely. We use Stripe for payment processing, which is PCI-DSS compliant and trusted by millions of businesses worldwide.</p>
      </div>
    </div>
  </div>

  <!-- Cancellation Feedback Modal -->
  <div data-cancellation-target="modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 items-center justify-center">
  <div class="bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 border border-gray-700 shadow-2xl">
    <h2 class="text-2xl font-bold text-white mb-4">We're Sorry to See You Go</h2>
    <p class="text-gray-400 mb-6">Help us improve by telling us why you're canceling:</p>
    
    <div class="space-y-4 mb-6">
      <label class="flex items-center gap-3 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 transition">
        <input type="radio" name="reason" value="too_expensive" data-cancellation-target="reason" class="w-4 h-4 text-indigo-600">
        <span class="text-white">Too expensive</span>
      </label>
      <label class="flex items-center gap-3 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 transition">
        <input type="radio" name="reason" value="not_using" data-cancellation-target="reason" class="w-4 h-4 text-indigo-600">
        <span class="text-white">Not using it enough</span>
      </label>
      <label class="flex items-center gap-3 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 transition">
        <input type="radio" name="reason" value="missing_features" data-cancellation-target="reason" class="w-4 h-4 text-indigo-600">
        <span class="text-white">Missing features I need</span>
      </label>
      <label class="flex items-center gap-3 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 transition">
        <input type="radio" name="reason" value="switching" data-cancellation-target="reason" class="w-4 h-4 text-indigo-600">
        <span class="text-white">Switching to another tool</span>
      </label>
      <label class="flex items-center gap-3 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 transition">
        <input type="radio" name="reason" value="other" data-cancellation-target="reason" class="w-4 h-4 text-indigo-600">
        <span class="text-white">Other</span>
      </label>
    </div>

    <textarea 
      name="feedback"
      data-cancellation-target="feedback" 
      placeholder="Any additional feedback? (optional)" 
      rows="3"
      class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none resize-none mb-6"
    ></textarea>

    <div class="flex gap-3">
      <button 
        data-action="click->cancellation#closeModal" 
        class="flex-1 px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-semibold rounded-lg transition"
      >
        Keep Pro
      </button>
      <button 
        data-action="click->cancellation#submitCancellation" 
        class="flex-1 px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg transition"
      >
        Cancel Subscription
      </button>
    </div>
  </div>
</div>
</div>
