<div class="max-w-2xl mx-auto py-8 px-4">
  <div class="bg-gray-800 border border-gray-700 rounded-2xl p-8">
    <h1 class="text-2xl font-bold text-white mb-6">Edit Mission</h1>
    
    <%= form_with model: @mission, class: "space-y-6" do |f| %>
      <!-- Title -->
      <div>
        <%= f.label :title, "Mission Title", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.text_field :title, class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none" %>
      </div>

      <!-- Description -->
      <div>
        <%= f.label :description, "Description / Notes", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.text_area :description, rows: 6, placeholder: "Add detailed mission instructions, context, or notes...", class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none resize-none" %>
      </div>

      <!-- Due Date -->
      <div>
        <%= f.label :due_at, "Due Date & Time", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.datetime_local_field :due_at, class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none" %>
      </div>

      <!-- Primary Agent -->
      <div>
        <%= f.label :agent_id, "Primary Agent", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.collection_select :agent_id, Current.user.workspace.users, :id, :name, {}, class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none" %>
      </div>

      <!-- Additional Assignees -->
      <div>
        <%= f.label :assigned_user_ids, "Additional Team Members", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <div class="space-y-2">
          <% Current.user.workspace.users.where.not(id: @mission.agent_id).each do |user| %>
            <label class="flex items-center gap-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 cursor-pointer transition">
              <%= check_box_tag 'mission[assigned_user_ids][]', user.id, @mission.assigned_users.include?(user), class: "w-4 h-4 text-indigo-600 bg-gray-600 border-gray-500 rounded focus:ring-indigo-500" %>
              <div class="flex items-center gap-2">
                <% if user.avatar.attached? %>
                  <%= image_tag user.avatar, class: "w-8 h-8 rounded-full object-cover" %>
                <% else %>
                  <div class="w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white font-bold text-sm">
                    <%= user.name[0] %>
                  </div>
                <% end %>
                <span class="text-white"><%= user.name %></span>
              </div>
            </label>
          <% end %>
        </div>
      </div>

      <!-- File Attachments -->
      <div>
        <%= f.label :attachments, "Attach Files", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.file_field :attachments, multiple: true, class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-indigo-600 file:text-white hover:file:bg-indigo-500 file:cursor-pointer" %>
        <p class="text-xs text-gray-500 mt-2">Upload images, documents, or any files related to this mission</p>
      </div>

      <!-- Status -->
      <div>
        <%= f.label :status, "Status", class: "block text-sm font-semibold text-gray-300 mb-2" %>
        <%= f.select :status, Mission.statuses.keys.map { |s| [s.titleize, s] }, {}, class: "w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none" %>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-3 pt-4">
        <%= f.submit "Save Changes", class: "px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-semibold rounded-lg cursor-pointer transition" %>
        <%= link_to "Cancel", @mission, class: "px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-semibold rounded-lg transition" %>
      </div>
    <% end %>
  </div>
</div>
